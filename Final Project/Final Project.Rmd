---
title: "Final Project"
author: Ting An Lai
date: December 2, 2019
job: QMSS Modern Data Structures
mode: selfcontained
always_allow_html: yes
output:
  ioslides_presentation:
    incremental: false
    smaller: false
    css:  "../custom.css" 
    keep_md: true
    highlighter : highlight
    toc: true
  html_document:
    toc: true
    toc_depth: 1
    keep_md: true
           
# runtime: shiny
---

# Save my clientID
```{r}
usethis::edit_r_environ()
```

#endpoint URL
```{r}
#import packages
library(httr)
endpoint <- "https://open-ic.epic.com/FHIR/api/FHIR/DSTU2/"
```

#Authentification
```{r}

a <- GET("https://open-ic.epic.com/argonaut/api/FHIR/Argonaut/metadata")
content(a)
View(a)


b <- GET("https://open-ic.epic.com/argonaut/oauth2/authorize?response_type=code&client_id=f23a337d-0301-4fa0-82d5-1645a2f25208&redirect_uri=https://github.com/QMSS-G5072-2019/Lai_Ting_An/tree/master/HealthAPI")

content(b)
View (b)
```

```{r}
library(RonFHIR)
# Setting up a fhirClient
client <- fhirClient$new("https://github.com/QMSS-G5072-2019/Lai_Ting_An/tree/master/HealthAPI")

# Setting up a fhirClient with OAuth 2.0
client <- fhirClient$new("Endpoint of FHIR server that supports SMART on FHIR OAuth2 access")

client_id <- "id"
client_secret <- "secret"
app_name <- "TestApp"
scopes <- c("patient/*.read")

app <- httr::oauth_app(appname = app_name, client_id, client_secret)
oauth_endpoint <- httr::oauth_endpoint(authorize = paste(client$authUrl, "?aud=", client$endpoint, sep=""), access = client$tokenUrl)

token <- httr::oauth2.0_token(endpoint = oauth_endpoint, app = app, scope = scopes)

client$setToken(token)



```

```{r}
library(httr)
a <- GET("http://makeup-api.herokuapp.com/api/v1/products.json?product=eyebrow")
str(a, max.level = 1)
View(a)
a$status_code

content(a, text)
```





